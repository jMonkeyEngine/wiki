<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.4"><title>Eclipse + jME3 + Android + JNI/NDK</title><link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"></head><body class="article toc2 toc-left"><div id="header"><div id="toolbar"><a href="https://github.com/jMonkeyEngine/wiki/edit/master/src/docs/asciidoc/jme3/eclipse_jme3_android_jnindk.adoc"><i class="fa fa-pencil-square" aria-hidden="true"></i></a><a href="https://github.com/jMonkeyEngine/wiki/new/master/src/docs/asciidoc/jme3/"><i class="fa fa-plus-square" aria-hidden="true"></i></a><input dir="auto" style="position: relative; vertical-align: top;" spellcheck="false" autocomplete="off" class="searchbox__input aa-input" id="doc-search" name="search" placeholder="Search in the doc" required="required" type="search"></div><h1>Eclipse + jME3 + Android + JNI/NDK</h1><div class="details"><span class="author" id="author"></span><br><span id="revnumber">version ,</span> <span id="revdate">2016/03/17 20:48</span></div><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1"><li><a href="#setting-up-jme3">Setting up JME3</a></li><li><a href="#workspace">Workspace</a></li><li><a href="#base-jme3-project-desktops">Base JME3 Project (Desktops)</a><ul class="sectlevel2"><li><a href="#running">Running</a></li><li><a href="#packaging">Packaging</a></li></ul></li><li><a href="#assets-project">Assets Project</a><ul class="sectlevel2"><li><a href="#packaging-2">Packaging</a></li></ul></li><li><a href="#android-project">Android Project</a><ul class="sectlevel2"><li><a href="#running-2">Running</a></li><li><a href="#packaging-deploying">Packaging / Deploying</a></li></ul></li><li><a href="#native-jni-ndk-project">Native (JNI + NDK) Project</a><ul class="sectlevel2"><li><a href="#building">Building</a></li><li><a href="#packaging-deploying-2">Packaging / Deploying</a></li></ul></li></ul></div></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>This guide will show you how to effectively set up your Eclipse environment for not only a basic JME3 project, but an Android project, an assets project, and a JNI project (including the ability to build for Android through NDK).</p></div>
<div class="paragraph"><p>While you do not have to create a project of each type to use Eclipse and this guide, note that the Android and JNI projects do require having a base Eclipse project to be applicable using this guide.</p></div>
<div class="paragraph"><p>The code samples provided in this guide should work for any IDE, but setting up/configuring your IDE to do what Eclipse does in this particular guide may require some creative workarounds.</p></div>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>Please note that projects that use Android UI elements or are created using Eclipse <strong>can not</strong> be ported to iOS. See <a href="../jme3/android.html">this page</a> on how to create a cross-platform project using the jME SDK <strong>that can also be edited in the Eclipse IDE</strong>. This saves you the setup work outlined below.</p></div></td></tr></table></div></div></div>
<div class="sect1"><h2 id="setting-up-jme3">Setting up JME3</h2><div class="sectionbody"><div class="paragraph"><p>I will assume you already have downloaded (and built, if necessary) the JME3 binaries. If not, either download the <a href="http://hub.jmonkeyengine.org/downloads/">latest SDK release</a>, <a href="http://updates.jmonkeyengine.org/stable/3.0/engine">engine build</a> (recommended for new users), or take a quick detour over to <a href="../jme3/build_from_sources.html">this guide</a> to build from source (recommended for advanced users).</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>One directory you should have on hand (or know where to find) is the location of the resulting library (JAR) files.</p></div></td></tr></table></div>
<div class="paragraph"><p>For the various methods of obtaining the libraries (as described above), the path is usually in one of the following places:</p></div>
<div class="ulist"><ul><li><p><strong>SDK</strong>: [SDK Install Dir]/jmonkeyplatform/libs</p></li><li><p><strong>Nightly</strong>: /libs</p></li><li><p><strong>Source</strong>: [SDK Dir]/sdk/build/cluster/libs</p></li></ul></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>Throughout the course of this guide, <strong>do not copy JAR files</strong> to any project directory - leave them in their original spots so they can be easily updated for when a JME3 update comes out or when you rebuild the source.</p></div></td></tr></table></div></div></div>
<div class="sect1"><h2 id="workspace">Workspace</h2><div class="sectionbody"><div class="paragraph"><p>If you are unfamiliar with Eclipse and how it lays out/stores its configuration, one of the first things that you should be aware of is that almost all settings that are set at a workspace-level (i.e. through <em>Window → Preferences</em>) are stored in the workspace.</p></div>
<div class="paragraph"><p>You can select your workspace either by starting Eclipse (if the initial prompt is enabled) or by navigating to <em>File → Switch Workspace → Other</em>.</p></div>
<div class="paragraph"><p><span class="image"><img src="../jme3/eclipse-switch-workspace.png" alt="Eclipse: Switch Workspace" width="" height=""></span></p></div>
<div class="paragraph"><p>For this guide, we&#8217;re going to create a new folder called <code>JMonkey</code> in our <code>C:\</code> drive, however this folder can be anywhere on your drive (the same applies for users of other operating systems). We will also switch to it as a workspace.</p></div></div></div>
<div class="sect2"><h3 id="base-jme3-project-desktops">Base JME3 Project (Desktops)</h3><div class="paragraph"><p><strong>Prerequisites</strong>:</p></div>
<div class="ulist"><ul><li><p>JME3 (downloaded/extracted/built/installed) libraries located</p></li></ul></div>
<div class="paragraph"><p>It&#8217;s time to create our base JME3 project, which is actually relatively easy. Go to <em>File → New → Java Project</em>.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">If you don&#8217;t see <em>Java Project</em>, you are more than likely in a perspective other than Java or Java EE. Simply select <em>Project…</em> and then select <em>Java → Java Project</em> from the window that appears.</td></tr></table></div>
<div class="paragraph"><p>Give your project a name (we&#8217;ll call ours <code>JMEclipse-Base</code>) and click <em>Finish</em>. The project should show up in the Project Explorer pane on the left.</p></div>
<div class="paragraph"><p>First, we need to configure our build path. Right click the new project entry and go to <em>Build Path → Configure Build Path</em>, and then select the <em>Libraries</em> tab.</p></div>
<div class="paragraph"><p>There are a number of libraries you&#8217;re going to need to include, as the 'core' JME3 system requires them.</p></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>There will be many libraries in the previously identified <code>libs</code> folder that aren&#8217;t initially used. Certain aspects of JME3 (for instance, collision detection) will require the appropriate JAR if your code requires that functionality. However, it is highly recommended you do NOT include every JAR in the <code>libs</code> folder due to the fact that exporting them all when they are not needed will result in a huge jar file (~60MB).</p></div></td></tr></table></div>
<div class="paragraph"><p>Click <em>Add External JARs…</em>, navigate to the JME3 <code>libs</code> folder (see <em>Setting up JME3</em> if you&#8217;re not sure where this is), and select each of the following:</p></div>
<div class="ulist"><ul><li><p>jME3-core.jar</p></li><li><p>jME3-desktop.jar</p></li><li><p>jME3-jogl.jar</p></li><li><p>jME3-lwjgl-natives.jar</p></li><li><p>jME3-lwjgl.jar</p></li><li><p>jogl-all.jar</p></li><li><p>lwjgl.jar</p></li><li><p>vecmath.jar</p></li></ul></div>
<div class="paragraph"><p>Add the JARs, hit <em>OK</em>, and you&#8217;ve successfully set up the base JME3 build path for your project.</p></div>
<div class="paragraph"><p>The last bit that must be added are assets. Note that while the SDK has a single way of managing your assets, assets can be handled in a number of ways in other IDEs.</p></div>
<div class="paragraph"><p>The rule for assets is that their files <strong>must be on the build path</strong>. This means that you can either include the inner folders directly in your project, or you can create a separate project (and thus, a separate JAR) for your assets.</p></div>
<div class="paragraph"><p>Alternatively, you can keep them in the local directory if you do not wish to package them with the JAR, though this may not be desirable for certain deployments (such as applets, Android apps, or JNLPs).</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>To include your assets within your base project, follow the <em>Assets</em> section without creating a new project. However, do note that this will make the process of including these assets in your Android project, if you create one, much harder.</p></div></td></tr></table></div>
<div class="paragraph"><p>Finally, the SDK creates a base source file for you that ends up being the main JME3 entry point. Since we&#8217;re using Eclipse, we&#8217;ll have to manually create that file.</p></div>
<div class="paragraph"><p>Right click your project, go to <em>New → Class</em>, and fill out the appropriate information:</p></div>
<div class="ulist"><ul><li><p><strong>Package</strong>: your package name (i.e. <code>com.jme3.test</code>)</p></li><li><p><strong>Name</strong>: the class name (i.e. <code>MyGame</code>)</p></li><li><p><strong>Superclass</strong>: <code>com.jme3.app.SimpleApplication</code></p></li></ul></div>
<div class="paragraph"><p>Then hit Finish. This will create and open the new class file. Eclipse should have automatically inserted the method “simpleInitApp() for you. This is where all of your game&#8217;s start up code will go.</p></div>
<div class="paragraph"><p>Finally, create a <code>main</code> function as the Java entry point:</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    MyGame app = <span class="keyword">new</span> MyGame();
    app.start();
}</code></pre></div></div>
<div class="sect2"><h3 id="running">Running</h3><div class="paragraph"><p>Running your JME3 project is quite simple in Eclipse. You can either <a href="http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.jdt.doc.user/tasks/tasks-java-local-configuration.htm">create a Java run configuration</a> or you can simply hit <code>CTRL + F11</code> to run the project (if Eclipse doesn&#8217;t know what to do, it will ask).</p></div></div>
<div class="sect2"><h3 id="packaging">Packaging</h3><div class="paragraph"><p>Packaging your JME3 project is also very straightforward. Assuming you heeded the warning stated earlier about not including every JAR in the <code>libs</code> folder, you should be able to right click your base JME3 project, go to <em>Export…</em>, select <em>Java → Runnable JAR file</em>, specify an output location and click <em>Finish</em>.</p></div>
<div class="paragraph"><p>If you have assets set up as a JAR, make sure to read the <em>Packaging</em> section under <em>Assets</em>.</p></div></div></div>
<div class="sect2"><h3 id="assets-project">Assets Project</h3><div class="paragraph"><p>Each JME project has a set of assets that are used to load textures, models, and other resources used by your game.</p></div>
<div class="paragraph"><p>As mentioned earlier, assets can be located/included in one of several ways. This section will describe how to include your project&#8217;s assets through the use of a separate JAR file, which has the added advantage of allowing you to update assets without needing to update the JAR itself. If you have a dynamic class-path system set up, this could be very useful.</p></div>
<div class="paragraph"><p>First, create another <strong>generic</strong> project by going to <em>File → New → Project… → General → Project</em> and giving it a name (we&#8217;ll call ours <code>JMEclipse-Assets</code>).</p></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>We create a General (non-Java) project for cleanliness because our assets will not require any special build settings or the like.</p></div></td></tr></table></div>
<div class="paragraph"><p>For new users, it&#8217;s a good idea to add the initial JME3 folders that the SDK creates, as they are referenced by many other guides on the web. To do this, for each of the following right click on the assets project and go to <em>New → Folder</em>, type in the name listed, and hit <em>Finish</em>:</p></div>
<div class="ulist"><ul><li><p>Interface</p></li><li><p>MatDefs</p></li><li><p>Materials</p></li><li><p>Models</p></li><li><p>Scenes</p></li><li><p>Shaders</p></li><li><p>Sounds</p></li><li><p>Textures</p></li></ul></div>
<div class="paragraph"><p>Although this specific structure is what the JMonkeyEngine SDK generates upon the creation of a new project, it is by no means the only way to structure your project. All asset loading methods will work with folder names other than those listed above.</p></div>
<div class="sect2"><h3 id="packaging-2">Packaging</h3><div class="paragraph"><p>Packaging your assets is also a simple process. Right click the assets project and click <em>Export…</em> and then select <em>Java → Jar file</em>. It will show a list of files you can export; make sure to uncheck all files such as <code>.classpath</code>, <code>.project</code>, and any <code>.jardesc</code> files you may have created. As well, ensure only the resources and assets you want to export are checked.</p></div>
<div class="paragraph"><p>Check <em>Export generated class files and resources</em>, select a destination for the JAR file, and check <em>Compress the contents of the JAR file</em>, <em>Add directory entries</em>, and <em>Overwrite existing files without warning</em>. Click <em>Finish</em>.</p></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>Optionally, you can click <em>Next</em> and specify a <code>.jardesc</code> file by checking <em>Save the description of this JAR in the workspace</em> and specifying a location for a <code>.jardesc</code> file. That way you can simply double-click the <code>.jardesc</code> file and easily re-export your assets when they change (remember, always refresh your project before exporting!).</p></div></td></tr></table></div></div></div>
<div class="sect2"><h3 id="android-project">Android Project</h3><div class="paragraph"><p><strong>Prerequisites</strong>:</p></div>
<div class="ulist"><ul><li><p>JME3 (downloaded/extracted/built/installed) libraries located</p></li><li><p>JME3 Base Project created (as described above)</p></li><li><p>Android SDK downloaded and the Android 8 (2.2) target installed (higher <abbr title="Application Programming Interface">API</abbr> versions work too but may limit compatibility when deploying)</p></li><li><p>Assets compiled into a JAR (see <em>Packaging</em> under <em>Assets</em>)</p></li><li><p><a href="http://developer.android.com/sdk/installing/installing-adt.html">Eclipse ADT plugin</a> installed</p></li></ul></div>
<div class="paragraph"><p>The Android project is a slightly more involved setup project, but is still quite simple, even for new users.</p></div>
<div class="paragraph"><p>To start, create another Android project by going <em>File → New → Project… → Android → Android Application Project</em>.</p></div>
<div class="paragraph"><p>Fill out the following information and then click Next:</p></div>
<div class="ulist"><ul><li><p><strong>Application Name</strong>: name of your application (i.e. <code>JMEclipse Test Project</code>)</p></li><li><p><strong>Project Name</strong>: name of the project in the workspace (i.e. <code>JMEclipse-Android</code>)</p></li><li><p><strong>Package Name</strong>: name of the base package, preferably the same as the one used in the base project (we&#8217;ll re-use <code>com.jme3.test</code>)</p></li><li><p><strong>Minimum Required SDK</strong>: <abbr title="Application Programming Interface">API</abbr> 8 (Must be AT LEAST SDK 8 for OpenGLES2 and JNI)</p></li></ul></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>Most of the lower options are defaulted based off of your ADT configuration and should work as-is.</p></div></td></tr></table></div>
<div class="paragraph"><p>After clicking <em>Next</em>, uncheck <em>Create activity</em> (JME3 provides a base activity class). You can check/uncheck <em>Create custom launcher icon</em> at your own preference.</p></div>
<div class="paragraph"><p>Make sure that <em>Mark this project as a library</em> is unchecked and hit <em>Finish</em> (or <em>Next</em> if you chose to create a custom launcher icon; this will take you to a customization page, after which you will be forced to finish).</p></div>
<div class="paragraph"><p>First, we need to set up our build path. Surprisingly enough, it&#8217;s much easier than the base project, though it is done a little differently.</p></div>
<div class="paragraph"><p>At the time of this guide&#8217;s writing, the latest release of the ADT/Eclipse plugin creates a <code>libs</code> folder within your project structure. This special folder automatically includes all of its contents on the build path.</p></div>
<div class="paragraph"><p>Normally, you would drop the JAR files directly into this folder. However, this is undesirable as future releases/builds of JME3 would require you to re-copy all of the JAR files. Instead, we will simply link them.</p></div>
<div class="paragraph"><p>For each of the following, right click the <code>libs</code> folder within your Android project and go to <em>New → File</em>, click <em>Advanced »</em>, check <em>Link to file in the file system</em>, click <em>Browse…</em>, navigate to the JME3 <code>libs</code> folder (as identified in the <em>Setting up JME3</em> section above), double click the listed JAR file, and then click <em>Finish</em>:</p></div>
<div class="ulist"><ul><li><p>jME3-android.jar</p></li><li><p>jME3-core.jar</p></li></ul></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>There will be many libraries in the previously identified <code>libs</code> folder that aren&#8217;t initially used. Certain aspects of JME3 (for instance, collision detection) will require the appropriate JAR if your code requires that functionality. However, it is highly recommended you do NOT include every JAR in the <code>libs</code> folder due to the fact that exporting them all when they are not needed will result in a huge jar file (~60MB).</p></div></td></tr></table></div>
<div class="paragraph"><p>As well, repeat the above step for your compiled assets JAR (see <em>Packaging</em> under <em>Assets</em>).</p></div>
<div class="paragraph"><p>Now that the core JME3 libraries have been added, we&#8217;ll need to include our base project&#8217;s code. To do this, right click on the Android project and go to <em>Build Path → Configure Build Path</em>, select the <em>Projects</em> tab, click <em>Add</em>, and select the base project (in our case, <code>JMEclipse-Base</code>).</p></div>
<div class="paragraph"><p>Lastly, select the <em>Order and Export</em> tab. Ensure that your base project (i.e. <code>JMEclipse-Base</code>), <em>Android Private Libraries</em>, <em>Android Dependencies</em>, and optionally <em>Google APIs</em> (if you have that target enabled) are checked. This step is important, or your project&#8217;s libraries/assets will NOT be exported into the end APK.</p></div>
<div class="paragraph"><p>Click <em>OK</em>, and your project&#8217;s build path will be set up.</p></div>
<div class="paragraph"><p>The next step is to create the application&#8217;s activity and edit <code>AndroidManifest.xml</code> to configure the project to actually use our JME3 project.</p></div>
<div class="paragraph"><p>First, right click on the Android project and go to <em>New → Class</em>, entering the following information and hitting <em>Finish</em>:</p></div>
<div class="ulist"><ul><li><p><strong>Package</strong>: your application package (it&#8217;s best to use the package specified in the project creation dialog; for this guide, we&#8217;ll re-use <code>com.jme3.test</code>)</p></li><li><p><strong>Name</strong>: the activity class' name (i.e. <code>JMEclipseActivity</code>)</p></li><li><p><strong>Superclass</strong>: <code>com.jme3.app.AndroidHarness</code></p></li></ul></div>
<div class="paragraph"><p>This will create a new activity class. In the resulting file, create a default constructor and add the following code:</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> JMEclipseActivity()
{
        <span class="comment">// Set the application class to run</span>
        appClass = <span class="string"><span class="delimiter">&quot;</span><span class="content">com.jme3.test.MyGame</span><span class="delimiter">&quot;</span></span>;

        <span class="comment">// Try ConfigType.FASTEST; or ConfigType.LEGACY if you have problems</span>
        eglConfigType = ConfigType.BEST;

        <span class="comment">// Exit Dialog title &amp; message</span>
        exitDialogTitle = <span class="string"><span class="delimiter">&quot;</span><span class="content">Quit game?</span><span class="delimiter">&quot;</span></span>;
        exitDialogMessage = <span class="string"><span class="delimiter">&quot;</span><span class="content">Do you really want to quit the game?</span><span class="delimiter">&quot;</span></span>;

        <span class="comment">// Choose screen orientation</span>
        screenOrientation = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE;

        <span class="comment">// Invert the MouseEvents X (default = true)</span>
        mouseEventsInvertX = <span class="predefined-constant">true</span>;

        <span class="comment">// Invert the MouseEvents Y (default = true)</span>
        mouseEventsInvertY = <span class="predefined-constant">true</span>;
}</code></pre></div></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>Pay close attention to the values above; <code>appClass</code> MUST be the full package + class name of the class in your base project that extends <code>SimpleApplication</code> (for advanced users, this is actually a subclass of <code>com.jme3.app.Application</code>).</p></div></td></tr></table></div>
<div class="sect2"><h3 id="running-2">Running</h3><div class="paragraph"><p>Running your Android project is just like <a href="http://developer.android.com/tools/building/building-eclipse.html">running any other Android project</a>. Assuming you&#8217;ve set up your build path correctly as instructed above, your application should deploy to any device/emulator and run as expected.</p></div></div>
<div class="sect2"><h3 id="packaging-deploying">Packaging / Deploying</h3><div class="paragraph"><p>Packaging your Android project is too vast to entirely cover in this guide. As this step is different for each project, I will simply link to this guide to <a href="http://developer.android.com/tools/publishing/app-signing.html">signing and exporting your APK</a> as it outlines the most common steps to exporting you Android application to be uploaded directly to Google Play (fmly. App Market).</p></div></div></div>
<div class="sect2"><h3 id="native-jni-ndk-project">Native (JNI + NDK) Project</h3><div class="paragraph"><p><strong>Prerequisites</strong>:</p></div>
<div class="ulist"><ul><li><p>JME3 Base Project created (as described above)</p></li><li><p><a href="http://www3.ntu.edu.sg/home/ehchua/programming/howto/EclipseCpp_HowTo.html">Eclipse CDT plugin</a> installed</p></li><li><p>At least one configured toolchain for compiling on desktop platforms (Cygwin/MinGW/MSVC/GCC/etc.)</p></li><li><p>Familiarity with JNI and how native libraries are included in a Java application&#8217;s architecture (this section will assume you do)</p></li><li><p>JDK for Java 6 or above</p></li></ul></div>
<div class="paragraph"><p><strong>If additionally building for Android</strong>:</p></div>
<div class="ulist"><ul><li><p>Android SDK downloaded and the Android 8 (2.2) target installed (higher <abbr title="Application Programming Interface">API</abbr> versions work too but may limit compatibility when deploying)</p></li><li><p>Android NDK downloaded</p></li><li><p>Optional: <a href="http://tools.android.com/recent/usingthendkplugin">NDK Eclipse plugin</a> installed (although I haven&#8217;t seen a real need for it quite yet - it&#8217;s mainly for building/launching native Activities)</p></li></ul></div>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>It should be mentioned that this section will not go into C/C++ best practices, sample code, or any details about the inner workings of JNI; instead, this section simply shows you how to set up the environment/configurations to create a near-seamless build environment for including your native code in both your base project as well as your Android project (if you&#8217;ve created one).</p></div></td></tr></table></div>
<div class="paragraph"><p>Building JNI is actually quite straightforward (assuming you know how the C/C++ build process works). Even for Android, the NDK provides a slick system for building/including your compiled binaries in your project.</p></div>
<div class="paragraph"><p>First, create a new C/C project by going to _File → New → Project… → C/C → C++ Project_ and clicking <em>Next</em>, giving it a name (we&#8217;ll use <code>JMEclipse-Native</code>), expanding <em>Shared Library</em> and selecting <em>Empty Project</em>, then selecting a toolchain (select the most appropriate for compiling on your immediate desktop/platform, even if you plan on compiling for Android). Click <em>Finish</em>.</p></div>
<div class="paragraph"><p>Next, we need to configure our build settings. Right click the native project, click <em>Properties</em> and go to <em>C/C++ Build → Settings</em>. Select the <em>Build Artifact</em> tab, ensure the drop down menu says <em>Shared Library</em>, and change the <em>Artifact name</em> field to what you want to call your eventual JNI module.</p></div>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>What you call your artifact is VERY important to how Java loads your library. For instance, linux dynamic library (.SO) objects require that the library have the “lib prefix. Keep this in mind when specifying an artifact name.</p></div></td></tr></table></div>
<div class="paragraph"><p>If you plan on building for Android, you must include an Android makefile in your project. In order for the build process to be as seamless as possible, this guide sets it up unlike most tutorials instruct.</p></div>
<div class="paragraph"><p>To do this, simply create a new file in your native project called <code>Android.mk</code> and <a href="http://www.kandroid.org/ndk/docs/ANDROID-MK.html">set it up accordingly</a>.</p></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>Even though the native project is not the Android project&#8217;s directory, keep the <code>LOCAL_PATH</code> variable set to <code>my-dir</code>. This is important!</p></div></td></tr></table></div>
<div class="paragraph"><p>Next, we need to create a configuration for the Android target.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>This step is only relevant/possible if you have the NDK Eclipse plugin installed. Otherwise, you will need to install awk/make (using Cygwin if on Windows) and build through the command line manually.</p></div></td></tr></table></div>
<div class="paragraph"><p>To do this, right click your native project, click <em>Properties</em>, and go to <em>C/C++ Build → Tool Chain Editor</em>. For the configuration, click <em>Manage Configurations…</em> and create new configuration(s) based on the current default configurations, putting “Android in the name. Lastly, click <em>OK</em>.</p></div>
<div class="paragraph"><p>For each of the Android configurations you just created, select them in the <em>Configuration</em> drop down menu, set <em>Current toolchain</em> to <em>Android GCC</em>, set <em>Current builder</em> to <em>Android Builder</em>, then click <em>Select Tools…</em>, remove everything from the right side and replace the last item with <em>Android GCC Compiler</em>. Click <em>Apply</em> and then <em>OK</em>.</p></div>
<div class="paragraph"><p>After the toolchains have been set up, go to <em>C/C++ Build</em> and select the <em>Builder Settings</em> tab. For each of the Android configurations, select them in the <em>Configuration</em> drop down menu and change the <em>Build directory</em> to the Android project directory by clicking <em>Workspace…</em> and selecting the Android project (in our case it&#8217;d be <code>JMEclipse-Android</code>).</p></div>
<div class="paragraph"><p>The last step in the Android setup is to create a symlink called <code>jni</code> (case sensitive) inside your Android project root that points to the root of your native project:</p></div>
<div class="ulist"><ul><li><p><strong>Windows</strong>: CMD prompt → <code>cd path\to\Android\project</code> → <code>mklink /J jni path\to\native\project</code></p></li><li><p><strong>Linux/Mac</strong>: Terminal → <code>cd path/to/Android/project</code> → <code>ln -sv path/to/native/project jni</code></p></li></ul></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>What this has essentially done is created a separate project for C/C++ building while tricking the Android project into thinking the source files are located directly in the Android project itself. With this configuration scheme, you can easily build regular shared libraries for desktop platforms as well as build/install the Android libraries using the NDK without the need to have a copy of the source code inside of the <code>jni</code> folder of an Android project. By setting the workspace for the Android builder and creating a link, it executes the NDK builder inside your Android project while serving the source files as if they existed in the <code>jni</code> folder.</p></div></td></tr></table></div>
<div class="paragraph"><p>Lastly, some additional include paths need to be added. Within the properties window, go to <em>C/C++ General → Paths and Symbols</em> and select the <em>Includes</em> tab.</p></div>
<div class="paragraph"><p>Under <em>Languages</em>, select <em>GNU C_ (or the correct C equivalent) and then _Add…</em>. Specify the absolute path to your JDK&#8217;s <code>include</code> folder, check <em>Add to all configurations</em>, and hit <em>OK</em>.</p></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>For Windows platforms, repeat the above step for the <code>win32</code> directory within the JDK&#8217;s <code>include</code> folder.</p></div></td></tr></table></div>
<div class="paragraph"><p>After hitting <em>OK</em>, you are now set to write your JNI code.</p></div>
<div class="sect2"><h3 id="building">Building</h3><div class="paragraph"><p>Building your native project is fairly straightforward.</p></div>
<div class="paragraph"><p>First, right click the native project, go to <em>Build Configurations</em>, select the configuration you want to build, and then right click the native project again and select <em>Build Project</em>. Short of packaging, that&#8217;s all there is to it.</p></div></div>
<div class="sect2"><h3 id="packaging-deploying-2">Packaging / Deploying</h3><div class="paragraph"><p>Packaging and deploying your native libraries is a two-sided topic. For Android, the NDK build script installs these for you, and they are packaged directly into the APK. For desktop applications, however, there are a multitude of ways to package your libraries - all of which are too vast to be included in this guide.</p></div>
<div class="paragraph"><p>These libraries, however, are simply JNI libraries and should be loaded as such. A simple web search will explain how JNI works and how to load these libraries.</p></div></div></div></div><div id="footer"><div id="footer-text">Version <br>Last updated 2017-11-14 05:28:25 +00:00</div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script>docsearch({
  apiKey: 'a736b6d93de805e26ec2f49b55013fbd',
  indexName: 'jmonkeyengine',
  inputSelector: '#doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});</script></body></html>