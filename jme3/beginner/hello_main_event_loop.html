<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.4"><meta name="keywords" content="documentation, state, states, intro, beginner, control, loop"><title>jMonkeyEngine 3 Tutorial (4) - Hello Update Loop</title><link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"></head><body class="article toc2 toc-left"><div id="header"><div id="toolbar"><a href="https://github.com/jMonkeyEngine/wiki/edit/master/src/docs/asciidoc/jme3/beginner/hello_main_event_loop.adoc"><i class="fa fa-pencil-square" aria-hidden="true"></i></a><a href="https://github.com/jMonkeyEngine/wiki/new/master/src/docs/asciidoc/jme3/beginner/"><i class="fa fa-plus-square" aria-hidden="true"></i></a><input dir="auto" style="position: relative; vertical-align: top;" spellcheck="false" autocomplete="off" class="searchbox__input aa-input" id="doc-search" name="search" placeholder="Search in the doc" required="required" type="search"></div><h1>jMonkeyEngine 3 Tutorial (4) - Hello Update Loop</h1><div class="details"><span class="author" id="author"></span><br><span id="revnumber">version ,</span> <span id="revdate">2016/03/17 20:48</span></div><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1"><li><a href="#code-sample">Code Sample</a></li><li><a href="#understanding-the-code">Understanding the Code</a></li><li><a href="#using-the-update-loop">Using the Update Loop</a></li><li><a href="#init-update-render">Init - Update - Render</a></li><li><a href="#exercises">Exercises</a></li><li><a href="#conclusion">Conclusion</a></li></ul></div></div><div id="content"><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>Previous: <a href="../../jme3/beginner/hello_asset.html">Hello Assets</a>,
Next: <a href="../../jme3/beginner/hello_input_system.html">Hello Input System</a></p></div>
<div class="paragraph"><p>Now that you know how to load assets, such as 3D models, you want to implement some gameplay that uses these assets. In this tutorial we look at the update loop. The update loop of your game is where the action happens.</p></div></div></div>
<div class="sect1"><h2 id="code-sample">Code Sample</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">jme3test.helloworld</span>;

<span class="keyword">import</span> <span class="include">com.jme3.app.SimpleApplication</span>;
<span class="keyword">import</span> <span class="include">com.jme3.material.Material</span>;
<span class="keyword">import</span> <span class="include">com.jme3.math.ColorRGBA</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.Geometry</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.shape.Box</span>;

<span class="comment">/** Sample 4 - how to trigger repeating actions from the main event loop.
 * In this example, you use the loop to make the player character
 * rotate continuously. */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloLoop</span> <span class="directive">extends</span> SimpleApplication {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args){
        HelloLoop app = <span class="keyword">new</span> HelloLoop();
        app.start();
    }

    <span class="directive">protected</span> Geometry player;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> simpleInitApp() {
        <span class="comment">/** this blue box is our player character */</span>
        <span class="predefined-type">Box</span> b = <span class="keyword">new</span> <span class="predefined-type">Box</span>(<span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">1</span>);
        player = <span class="keyword">new</span> Geometry(<span class="string"><span class="delimiter">&quot;</span><span class="content">blue cube</span><span class="delimiter">&quot;</span></span>, b);
        Material mat = <span class="keyword">new</span> Material(assetManager,
          <span class="string"><span class="delimiter">&quot;</span><span class="content">Common/MatDefs/Misc/Unshaded.j3md</span><span class="delimiter">&quot;</span></span>);
        mat.setColor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Color</span><span class="delimiter">&quot;</span></span>, ColorRGBA.Blue);
        player.setMaterial(mat);
        rootNode.attachChild(player);
    }

    <span class="comment">/* Use the main event loop to trigger repeating actions. */</span>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> simpleUpdate(<span class="type">float</span> tpf) {
        <span class="comment">// make the player rotate:</span>
        player.rotate(<span class="integer">0</span>, <span class="integer">2</span>*tpf, <span class="integer">0</span>);
    }
}</code></pre></div></div>
<div class="paragraph"><p>Build and run the file: You see a constantly rotating cube.</p></div></div></div>
<div class="sect1"><h2 id="understanding-the-code">Understanding the Code</h2><div class="sectionbody"><div class="paragraph"><p>Compared to our previous code samples you note that the player Geometry is now a class field. This is because we want the update loop to be able to access and transform this Geometry. As usual, we initialize the player object in the <code>simpleInitApp()</code> method.</p></div>
<div class="paragraph"><p>Now have a closer look at the <code>simpleUpdate()</code> method – this is the update loop.</p></div>
<div class="ulist"><ul><li><p>The <code>player.rotate(0, 2*tpf, 0);</code> line changes the rotation of the player object.</p></li><li><p>We use the <code>tpf</code> variable (“time per frame) to time this action depending on the current frames per second rate. This simply means that the cube rotates with the same speed on fast and slow machines, and the game remains playable.</p></li><li><p>When the game runs, the rotate() code is executed again and again.</p></li></ul></div></div></div>
<div class="sect1"><h2 id="using-the-update-loop">Using the Update Loop</h2><div class="sectionbody"><div class="paragraph"><p>A rotating object is just a simple example. In the update loop, you typically have many tests and trigger various game actions. This is where you update score and health points, check for collisions, make enemies calculate their next move, roll the dice whether a trap has been set off, play random ambient sounds, and much more.</p></div>
<div class="ulist"><ul><li><p>The <code>simpleUpdate()</code> method starts running after the <code>simpleInitApp()</code> method has initialized the scene graph and state variables.</p></li><li><p>JME3 executes everything in the <code>simpleUpdate()</code> method repeatedly, as fast as possible.</p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>Use the loop to poll the game state and then initiate actions.</p></li><li><p>Use the loop to trigger reactions and update the game state.</p></li><li><p>Use the loop wisely, because having too many calls in the loop also slows down the game.</p></li></ol></div></li></ul></div></div></div>
<div class="sect1"><h2 id="init-update-render">Init - Update - Render</h2><div class="sectionbody"><div class="paragraph"><p>Note the the three phases of every game:</p></div>
<div class="ulist"><ul><li><p><strong>Init:</strong> The <code>simpleInitApp()</code> method is executed only <em>once</em>, right at the beginning;</p></li><li><p><strong>Update:</strong> The <code>simpleUpdate()</code> method runs <em>repeatedly</em>, during the game.</p></li><li><p><strong>Render:</strong> After every update, the jMonkeyEngine <em>automatically</em> redraws (<code>renders</code>) the screen for you.</p></li></ul></div>
<div class="paragraph"><p>Since rendering is automatic, initialization and updating are the two most important concepts in a SimpleApplication-based game for you:</p></div>
<div class="ulist"><ul><li><p>The <code>simpleInitApp()</code> method is the application&#8217;s “first breath.<br>
Here you load and create game data (once).</p></li><li><p>The <code>simpleUpdate()</code> method is the application&#8217;s “heartbeat (the time unit is called <code>ticks</code>).<br>
Here you change their properties to update the game state (repeatedly).</p></li></ul></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>Everything in a game happens either during initialization, or during the update loop. This means that these two methods grow very long over time. Follwo these two strategies to spread out init and update code over several modular Java classes:</p></div>
<div class="ulist"><ul><li><p>Move code blocks from the simpleInitApp() method to <a href="../../jme3/advanced/application_states.html">AppStates</a>.</p></li><li><p>Move code blocks from the simpleUpdate() method to <a href="../../jme3/advanced/custom_controls.html">Custom Controls</a>.</p></li></ul></div>
<div class="paragraph"><p>Keep this in mind for later when your application grows.</p></div></td></tr></table></div></div></div>
<div class="sect1"><h2 id="exercises">Exercises</h2><div class="sectionbody"><div class="paragraph"><p>Here are some fun things to try:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>What happens if you give the rotate() method negative numbers?</p></li><li><p>Can you create two Geometries next to each other, and make one rotate twice as fast as the other? (use the <code>tpf</code> variable)</p></li><li><p>Can you make a cube that pulsates? (grows and shrinks)</p></li><li><p>Can you make a cube that changes color? (change and set the Material)</p></li><li><p>Can you make a rolling cube? (rotate around the x axis, and translate along the z axis)</p></li></ol></div>
<div class="paragraph"><p>Look back at the <a href="../../jme3/beginner/hello_node.html">Hello Node</a> tutorial if you do not remember the transformation methods for scaling, translating, and rotating.</p></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>Link to user-proposed solutions: <a href="../../jm3/solutions.html">Some proposed solutions</a><br>
<u>Be sure to try to solve them for yourself first!</u></p></div></td></tr></table></div></div></div>
<div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>Now you are listening to the update loop, “the heart beat of the game, and you can add all kinds of action to it.</p></div>
<div class="paragraph"><p>The next thing the game needs is some <em>inter</em>action! Continue learning how to <a href="../../jme3/beginner/hello_input_system.html">respond to user input</a>.</p></div>
<hr>
<div class="paragraph"><p>See also:</p></div>
<div class="ulist"><ul><li><p>Advanced jME3 developers use <a href="../../jme3/advanced/application_states.html">Application States</a> and <a href="../../jme3/advanced/custom_controls.html">Custom Controls</a> to implement game mechanics in their update loops. You will come across these topics again later when you proceed to more advanced documentation.</p></li></ul></div></div></div></div><div id="footer"><div id="footer-text">Version <br>Last updated 2017-11-14 05:28:25 +00:00</div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script>docsearch({
  apiKey: 'a736b6d93de805e26ec2f49b55013fbd',
  indexName: 'jmonkeyengine',
  inputSelector: '#doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});</script></body></html>